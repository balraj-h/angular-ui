language: javascript
node_js:
 - "14"
env:
 - NODE_ENV=ci
dist: trusty
services:
  - docker
cache:
 directories:
  - node_modules
  - client/node_modules
install:
 - npm ci
script:
 - npm run build
 - npm run test
 - docker login -u $DOCKER_USERNAME -p $DOCKER_PASSWORD
 - docker build -t balrrazh/balraj-repository1 .
 - docker push balrrazh/balraj-repository1:latest
 - wget -qO- https://toolbelt.heroku.com/install-ubuntu.sh | sh
 - heroku login
 - heroku container:login
 - heroku container:push web --app angular-ui-app
 - heroku container:release web --app angular-ui-app
